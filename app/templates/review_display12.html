<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title></title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
        <link rel="stylesheet" href="static/css/styles.css">
        <link rel="stylesheet"href="{{ url_for('static', filename='review_display12.css') }}"> 
    </head>
    <body>

        <nav class="navbar"> 
            <i class="bi bi-chevron-left" onclick="goToLandingPage50('back')"></i>
              
       </nav>
       <div class="text-background">
        <br><br><h2><u>Driven Dynamics</u></h2>
        <h3 class="h3">New & Used <span style="color:  blue;"> Cars </span></h3>
      </div>

      <div>
        <img class="textparagraph" src="{{ url_for('static', filename='/images/sssss.png') }}" alt="Example Image">
        <div class="text-block">
            <p>Timely delivery and buyer satisfaction.</p>
          </div>

      </div>
    
       {% for display in display %}
       <div class="notification-container">
           <div class="notification">
               <div class="notification-header">
                   <h3>New Review</h3>
                   <button class="close-btn">X</button>
               </div>
               <div class="notification-body">
                   <p><u>See our daily review.</u></p>
                   <div class="image-container">
                       <img src="static/images/{{display.image}}" width="300" height="200">
                   </div>
                   <div class="buyer-info">
                       <p><strong>Name:</strong> {{display.name}}</p>
                       <p><strong>Model:</strong> {{display.model}}</p>
                       <p><strong>Make:</strong> {{display.make}}</p>
                       <p><strong>Message:</strong> {{display.review_text}}</p>
                       <p><strong>Rating:</strong> {{display.rating}}</p>
                   </div>

                   <form class="editForm">
                    <input type="hidden" name="edit_id" value="{{display._id}}">
                    <br>
                    <input type="button" class="btn btn-primary"  value="Edit" onclick="editDisplay(this)">
                </form>


               <!-- Trigger Button -->
               <button id="deleteBtn" class="btn btn-primary" style="margin-left: 110px ; margin-right: 90px; margin-top:5px;">Delete</button>

<!-- The Modal -->
<div id="deleteModal" class="modal">
    <!-- Modal content -->
    <div class="modal-content">
        <h2>Confirm Delete</h2>
        <p>Are you sure you want to delete this review?</p>
        <form id="deleteForm" action="/delete_review" method="POST">
            <input type="hidden" id="delete_id" name="delete_id" value="{{ display._id }}">
            <div class="button-container">
                <button type="submit" class="btn btn-yes">Yes</button>
                <button type="button" class="btn btn-no" onclick="closeDeleteModal()">No</button>
            </div>
        </form>
    </div>
</div>

              <div class="edit-container" style="display:none;">
                <form class="saveForm">
                    <input type="hidden" name="edit_id" value="{{display._id}}">
                   <strong> <label>Name: <input type="text" name="name" value="{{display.name}}"></label><br></strong>
                   <strong> <label>Model: <input type="text" name="model" value="{{display.model}}"></label><br> </strong>
                    <strong>  <label>Make: <input type="text" name="make" value="{{display.make}}"></label><br> </strong>
                    <strong>  <label>Message: <textarea name="review_text">{{display.review_text}}</textarea></label><br> </strong>
                    <strong> <label>Rating: <input type="number" name="rating" value="{{display.rating}}"></label><br> </strong>
                    <input type="button" class="btn btn-primary" value="Save" onclick="saveDisplay(this)">
                    <input type="button" class="btn btn-primary" value="Cancel" onclick="closeEdit(this)">
                </form>
            </div>
            
                  
               </div>
           </div>
       </div>
       {% endfor %}

   
        
       <script src="{{ url_for('static', filename='script.js') }}"></script>
    </body>

    <script>
      function editDisplay(button) {
        const notificationBody = button.closest('.notification-body');
        const editContainer = notificationBody.querySelector('.edit-container');
        editContainer.style.display = 'block';
    }
    
    function saveDisplay(button) {
        const form = button.closest('.saveForm');
        const editId = form.querySelector('input[name="edit_id"]').value;
        const name = form.querySelector('input[name="name"]').value;
        const model = form.querySelector('input[name="model"]').value;
        const make = form.querySelector('input[name="make"]').value;
        const reviewText = form.querySelector('textarea[name="review_text"]').value;
        const rating = form.querySelector('input[name="rating"]').value;
    
        fetch('/edit_review', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ 
                edit_id: editId, 
                name: name,
                model: model,
                make: make,
                review_text: reviewText,
                rating: rating 
            })
        })
        .then(response => {
            if (response.ok) {
             
              
                location.reload()
            } else {
                console.error('Failed to edit review');
            }
        })
        .catch(error => {
            console.error('Error:', error);
        });
    }
    
    function closeEdit(button) {
        const notificationBody = button.closest('.notification-body');
        const editContainer = notificationBody.querySelector('.edit-container');
        editContainer.style.display = 'none';
    }
    
  </script>
  
 
    <script>
    
// Get the modal
var modal = document.getElementById("deleteModal");

// Get the button that opens the modal
var btn = document.getElementById("deleteBtn");

// Get the <span> element that closes the modal
var span = document.getElementsByClassName("close")[0];

// When the user clicks on the button, open the modal
btn.onclick = function() {
    modal.style.display = "block";
}

// When the user clicks on <span> (x), close the modal
span.onclick = function() {
    modal.style.display = "none";
}

// When the user clicks anywhere outside of the modal, close it
window.onclick = function(event) {
    if (event.target == modal) {
        modal.style.display = "none";
    }
}



function closeDeleteModal() {
  var modal = document.getElementById("deleteModal");
  modal.style.display = "none";
  window.location.href = "https://driven-dynamics.onrender.com/review_display12";
}

    </script>
</html>